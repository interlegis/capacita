{% extends 'capacita/base.html' %}

{% block content %}

    <div class="table_div">
        {% if orgao != '' %}
        <h2 class="ui dividing header">Usuários da {{orgao}}</h2>
        {% else %}
        <h2 class="ui dividing header">Usuários do Sistema</h2>
        {% endif %}
        
        <p>As permissões indicadas na tabela indicam se o Usuário tem permissão para inserir necessidades e editá-las. Tal usuário possui essa permissão se for um Gestor, Admin ou um Solicitante com permissão concedida</p>
        <form class="ui form" method="get">
            <div class="two fields">
                <div class="select_orgao field">
                    <label>Órgão</label>
                    <select name="orgao" id="" onchange="this.form.submit()">
                        <option value="">----------</option>
                        <option value="">Todos</option>
                        {% for orgao in orgaos %}
                            <option value="{{orgao.cod_orgao}}">{{orgao}}</option>
                        {% endfor %}
                    </select>
                </div>
            </div>
        </form>
        
        <table class="ui celled padded table">
            <thead>
                <tr class="center aligned">
                <th>Nome</th>
                <th>Permissão</th>
                </tr>
            </thead>
            <tbody>
                
                {% for user in users %}
                 
                    <tr class="center aligned">
                        <td> <a style="color: black;" href="/usuarios/{{user.id}}/edit/">{{user.username}}</a></td>
                        {% if user.profile.permissao_necessidade == True %}
                            <td><div class="ui toggle checkbox checked permitido">
                                <input value="{{user.id}}" class="permitido" type="checkbox" name="public">
                            </div></td>
                        {% endif %}
                        {% if user.profile.permissao_necessidade == False %}
                            <td><div class="ui toggle checkbox checked sem_permissao">
                                <input value="{{user.id}}" class="sem_permissao" type="checkbox" name="public">
                            </div></td>
                        {% endif %}
                    </tr>
                {% endfor %}

            </tbody>
        </table>
        <br>
        <a href="/usuarios/new/"><button class="ui button basic secondary">Novo</button></a>
    </div>

    {% endblock %}
